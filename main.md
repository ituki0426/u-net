---
marp: true
---
<!--
headingDivider: 1
-->

Fully Convolutinal Networks for Semantic Segmentation

FCNはエンドtoエンド、ピクセルtoピクセルでのセグメンテーションの学習を可能にした。

FCN以前、画像全体の分類、バウンディングボックスによる物体検出、部位やキーポイントの予測、局所的な対応関係の推定などのタスクにCNNは使われていた。

しかも、VGGやAlexNet、GoogleNetなど、画像分類向けに学習されたモデルを流用して、セグメンテーション向けにファインチューニングができる。


# U-Net: Convolutional Networks for Biomedical Image Segmentation

U-Netの目的は医学的画像セグメンテーション。しかし、医学的画像は何千枚ものアノテーション付きデータを用意することが難しい。
そこでFCNアーキテクチャを修正・拡張し、少数の学習画像でも機能し、より精密なセグメンテーションを実現できるようにしたのがU-Net

そこで Ciresanらはスライディング・ウィンドウ方式(画像上を小さなウィンドウ（パッチ）で走査し，その領域ごとに分類器を適用する手法)でネットワークを訓練し，各画素を中心とした局所領域（パッチ）を入力として与えることで画素ごとのクラスラベルを予測しました。

このネットワークは局所化（localization）が可能になる。

パッチ単位で見ると，訓練データ量は画像枚数に比べてはるかに増大する。

---

明らかに Ciresanらの手法には二つの欠点があります。

ネットワークを各パッチごとに個別に実行しなければならず，重なり合うパッチによる計算の冗長性が大きいため，非常に遅い。

局所化精度とcontext利用の間にトレードオフがある。

大きなパッチでは多くのプーリング層が必要になり，局所化精度が低下する一方で，小さなパッチではネットワークが参照できるcontextが限られてしまう。

その後、複数の層からの特徴量を同時に考慮できる分類器出力が提案され、優れた局所化精度とcontext usageを同時に実現可能となる。

これを洗練させたアーキテクチャであるがFCNである。


---

U-netはFCNアーキテクチャを修正・拡張し、少数の学習画像でも機能し、より精密なセグメンテーションを実現できるようにしています

![](./img/image%20copy%203.png)

---

- エンドtoエンド
- 弾性変形によるデータ拡張のおかげで少ないアノテーション付きデータ
- 高速に推論できる。（当時のGPUで512×512の画像のセグメンテーションに１秒未満）
- トレーニング時間もNVidia Titan GPU（6 GB）でわずか10時間